
# О программе

Timetable - программа на языке python 3.x для еженедельного получения всего доступного расписания КГБПОУ «АПЭК» для вашей группы в виде текстовых таблиц.

### Быстрый старт

Обновить список, Отделения > ПРОБЕЛ > E > I > E.

# Важно

В настоящий момент ведется поддержка исключительно расписаний формата docx.

# Зависимости

Для работы программы необходим python версии 3.x с следующими модулями:
- [texttable](https://pypi.org/project/texttable/)
- [lxml.etree](https://pypi.org/project/lxml/)
- [bs4](https://pypi.org/project/bs4/)

Используйте установщик pip для простой установки. Достаточно вставить в командную строку следующие команды:
```
pip install texttable
pip install lxml
pip install bs4
```

### Не видит pip?

Папка python скриптов `.../Python/Scripts/` должна быть в системных путях для того, чтобы командная строка могла найти pip. Если там есть python.exe, то попробуйте `python.exe -m pip`.


# Настройка

Файл preferences.json содержит настройки предпочтений. Он сбрасывается к настройкам по умолчанию, если его невозможно прочитать.

### Ключ notepad

Программа, в которой откроется результат конвертации документа расписания в текстовые таблицы. По умолчанию «notepad.exe» (содержится в системных путях Windows). Ключ должен содержать имя программы (если она в системных путях) или полный путь к ней (к примеру, «"D:/Program Files/Sublime Text 3/sublime_text.exe"»).

По умолчанию:
```
"notepad": "notepad.exe"
```

#### Ключ groups

Белый список групп. В результат конвертации включатся только группы из этого списка. Следует понимать, что люди могут ошибиться в написании имени группы в исходном документе расписания и программа не включит ее в результат. Важно! Значения не должны содержать заглавных букв!

По умолчанию:
```
"groups": [
    "11исип202"
]
```

#### Ключ departaments

Список приоритетных отделений. Отделения из этого списка будут подняты вверх в списке выбора документов для конвертации.

К примеру у нас есть документ с именем «! 06.11.2020  Расписание отделения информационных и юридических специальностей.docx». Из него получается имя отделения «Расписание отделения информационных и юридических специальностей» с помощью регулярного выражения «"( |^)(?=(Р|р))[а-яА-Яa-zA-Z -]+"». Этот документ будет поднят в списке вверх, если, пройдясь по значениям departaments, мы найдем совпадение с именем отделения, к примеру, с «информ».

По умолчанию:
```
"departaments": [
    "информ"
]
```
